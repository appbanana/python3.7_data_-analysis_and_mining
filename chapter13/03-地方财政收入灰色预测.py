import pandas as pd
from GM11 import GM11

if __name__ == '__main__':
    file_name = './data/data1.csv'
    data_df = pd.read_csv(file_name)
    data_df.index = range(1994, 2014)

    data = data_df.copy()
    data.loc[2014] = None
    data.loc[2015] = None

    # 因为02中x12为0 所以删掉
    del data['x12']
    for column_name in data.columns:
        f = GM11(data.loc[1994: 2013, column_name].values)[0]
        data.loc[2014, column_name] = f(len(data) - 1)
        data.loc[2015, column_name] = f(len(data))
        if column_name == 'y':
            for year in range(1994, 2015):
                data.loc[2014, column_name] = f(len(data) - 1)

        data[column_name] = data[column_name].round(decimals=2)

    data.to_excel('./temp/data1_GM11.xls')
    print(data)

    """
                  x1       x2       x3        x4        x5          x6       x7        x8      x9      x10     x11       x13        y
    1994  3831732.00   181.54   448.19   7571.00   6212.70  6370241.00   525.71    985.31   60.62    65.66  120.00   5321.00    64.87
    1995  3913824.00   214.63   549.97   9038.16   7601.73  6467115.00   618.25   1259.20   73.46    95.46  113.50   6529.00    99.75
    1996  3928907.00   239.56   686.44   9905.31   8092.82  6560508.00   638.94   1468.06   81.16    81.16  108.20   7008.00    88.11
    1997  4282130.00   261.58   802.59  10444.60   8767.98  6664862.00   656.58   1678.12   85.72    91.70  102.20   7694.00   106.07
    1998  4453911.00   283.14   904.57  11255.70   9422.33  6741400.00   758.83   1893.52   88.88   114.61   97.70   8027.00   137.32
    1999  4548852.00   308.58  1000.69  12018.52   9751.44  6850024.00   878.26   2139.18   92.85   152.78   98.50   8549.00   188.14
    2000  4962579.00   348.09  1121.13  13966.53  11349.47  7006896.00   923.67   2492.74   94.37   170.62  102.80   9566.00   219.91
    2001  5029338.00   387.81  1248.29  14694.00  11467.35  7125979.00   978.21   2841.65   97.28   214.53   98.90  10473.00   271.91
    2002  5070216.00   453.49  1370.68  13380.47  10671.78  7206229.00  1009.24   3203.96  103.07   202.18   97.60  11469.00   269.10
    2003  5210706.00   533.55  1494.27  15002.59  11570.58  7251888.00  1175.17   3758.62  109.91   222.51  100.10  12360.00   300.55
    2004  5407087.00   598.33  1677.77  16884.16  13120.83  7376720.00  1348.93   4450.55  117.15   249.01  101.70  14174.00   338.45
    2005  5744550.00   665.32  1905.84  18287.24  14468.24  7505322.00  1519.16   5154.23  130.22   303.41  101.50  16394.00   408.86
    2006  5994973.00   738.97  2199.14  19850.66  15444.93  7607220.00  1696.38   6081.86  128.51   356.99  102.30  17881.00   476.72
    2007  6236312.00   877.07  2624.24  22469.22  18951.32  7734787.00  1863.34   7140.32  149.87   429.36  103.40  20058.00   838.99
    2008  6529045.00  1005.37  3187.39  25316.72  20835.95  7841695.00  2105.54   8287.38  169.19   508.84  105.90  22114.00   843.14
    2009  6791495.00  1118.03  3615.77  27609.59  22820.89  7946154.00  2659.85   9138.21  172.28   557.74   97.50  24190.00  1107.67
    2010  7110695.00  1304.48  4476.38  30658.49  25011.61  8061370.00  3263.57  10748.28  188.57   664.06  103.20  29549.00  1399.16
    2011  7431755.00  1700.87  5243.03  34438.08  28209.74  8145797.00  3412.21  12423.44  204.54   710.66  105.50  34214.00  1535.14
    2012  7512997.00  1969.51  5977.27  38053.52  30490.44  8222969.00  3758.39  13551.21  213.76   760.49  103.00  37934.00  1579.68
    2013  7599295.00  2110.78  6882.85  42049.14  33156.83  8323096.00  4454.55  15420.14  228.46   852.56  102.60  41972.00  2088.14
    2014  8142148.24  2239.29  7042.31  43611.84  35046.63  8505522.58  4600.40  18686.28  241.27  1052.28  101.50  44506.47  2613.72
    2015  8460489.28  2581.14  8166.92  47792.22  38384.22  8627139.31  5214.78  21474.47  257.95  1197.04  101.41  49945.88  3128.77

    """

