import pandas as pd

if __name__ == '__main__':
    file_path = './data/catering_sale_all.xls'
    sale_all_data = pd.read_excel(file_path, index_col=u'日期')
    print(sale_all_data.head())
    # 获取索引列
    # print(sale_all_data.index)
    print('-----****------' * 5)

    """
    method  pearson为Pearson相关系数 要求变量服从正态分布
            spearman 不服从正态分布的变量，分类可以采用这个系数
            kendall
    """
    # 返回相关系数矩阵 即给出任意两款菜式之间的关系
    result = sale_all_data.corr(method='pearson')
    """
               百合酱蒸凤爪    翡翠蒸香茜饺   金银蒜汁蒸排骨     乐膳真味鸡     蜜汁焗餐包      生炒菜心    铁板酸菜豆腐     香煎韭菜饺     香煎罗卜糕    原汁原味菜心
    百合酱蒸凤爪   1.000000  0.009206  0.016799  0.455638  0.098085  0.308496  0.204898  0.127448 -0.090276  0.428316
    翡翠蒸香茜饺   0.009206  1.000000  0.304434 -0.012279  0.058745 -0.180446 -0.026908  0.062344  0.270276  0.020462
    金银蒜汁蒸排骨  0.016799  0.304434  1.000000  0.035135  0.096218 -0.184290  0.187272  0.121543  0.077808  0.029074
    乐膳真味鸡    0.455638 -0.012279  0.035135  1.000000  0.016006  0.325462  0.297692 -0.068866 -0.030222  0.421878
    蜜汁焗餐包    0.098085  0.058745  0.096218  0.016006  1.000000  0.308454  0.502025  0.155428  0.171005  0.527844
    生炒菜心     0.308496 -0.180446 -0.184290  0.325462  0.308454  1.000000  0.369787  0.038233  0.049898  0.122988
    铁板酸菜豆腐   0.204898 -0.026908  0.187272  0.297692  0.502025  0.369787  1.000000  0.095543  0.157958  0.567332
    香煎韭菜饺    0.127448  0.062344  0.121543 -0.068866  0.155428  0.038233  0.095543  1.000000  0.178336  0.049689
    香煎罗卜糕   -0.090276  0.270276  0.077808 -0.030222  0.171005  0.049898  0.157958  0.178336  1.000000  0.088980
    原汁原味菜心   0.428316  0.020462  0.029074  0.421878  0.527844  0.122988  0.567332  0.049689  0.088980  1.000000

    """
    print(result)
    print('-----****------' * 5)
    # 获取其中两个菜的相关性  => 0.45563816592235
    print(sale_all_data[u'百合酱蒸凤爪'].corr(sale_all_data[u'乐膳真味鸡']))
